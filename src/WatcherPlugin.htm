<!DOCTYPE html>
<html>
<head>
    <title>Simple .watcher()Plug-in Example</title>
    <script src="scripts/jquery-1.11.1.min.js" type="text/javascript"></script>

    <!-- just for the samples -->
    <script src="scripts/ww.jquery.min.js" type="text/javascript"></script>
    <script src="scripts/jquery-watch.js"></script>

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css" />
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet" />
    <style>
        .notebox {            
            top: 230px;
            left: 200px;
            width: 300px;
            height: 250px;
            position: absolute;
            z-index: 20;
            padding: 20px;
            background-color: lightsteelblue;
        }
         .class_true {
             background: steelblue !important;
             color: white;
         }

        .class_false {
            background: burlywood !important;
            color: black;
        }
        .descriptionheader {
            padding: 20px;
            background: lightsteelblue;
        }
    </style>

</head>
<body>
    <form id="form1">
        <nav class="navbar navbar-default" role="navigation" style="margin-bottom: 0">
            <div class="container-fluid">
                <!-- Brand and toggle get grouped for better mobile display -->
                <div class="navbar-header">
                    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                        <span class="sr-only">Toggle navigation</span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                    <a class="navbar-brand" href="#"><i class="fa fa-eye"></i> jquery-watch</a>                    
                </div>
            
                <!-- Collect the nav links, forms, and other content for toggling -->
                <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
                    <ul class="nav navbar-nav">
                        <li class="active"><a href="http://github.com/rickstrahl/jquery-watch"><i class="fa fa-github"></i> GitHub</a></li>
                        <li><a id="lnkRedisplayWindow" href="javascript:{}" class="btn btn-sm btn-default"><i class="fa fa-close"></i> Show/Hide Window</a></li>                      
                    </ul>
                </div>
            </div>
        </nav>
        <aside class="descriptionheader">
            This page demonstrates the watcher plug-in that can be used to observe any Css property
            change and cause a notification in response. In this example a drag operation is performed
            on the blue box and the black box that simulates a shadow is dragged along based on the
            notification of various Css properties includes top, left, height and width, visible etc.
            Notice how the shadow stays 'attached' to the blue box which is all handled via the
            event handler fired on change of each property.
        </aside>
        
        <div id="AlertBox" class="alert alert-info" style="display:none;margin-top:none; border-radius:0">
            <i class="fa fa-info"></i>
            <span id="msg"></span>
        </div>
        
        <div class="container">
      
            <div class="container">
                <div id="notebox" class="notebox" >
                    Go ahead drag me around and close me!
                </div>

                <div id="shadow" style="background-color: Gray; z-index: 19;position:absolute;display: none;">

                </div>
            </div>
            
            
        </div>
        <script type="text/javascript">
            $(document).ready(function () {
                var counter = 0;
                $("#shadow").show();
                var el = $("#notebox");
                el.draggable().closable();

                // Update a CSS Class on a timer
                var state = false;
                setInterval(function () {
                    //$("#notebox").css("Drag me around " + new Date());
                    $("#notebox").removeClass("class_true");
                    $("#notebox").removeClass("class_false");
                    $("#notebox").addClass("class_" + state);
                    state = !state;
                }, 3000);


                el.watch("top,left,opacity,attr_class", function(data, i) {
                    // element affected is 'this'
                    var el = $(this);

                    var sh = $("#shadow");

                    var propChanged = data.props[i];
                    var valChanged = data.vals[i];

                    counter++;

                    showStatus(" Changed Property: " + propChanged + "  -  New Value: " + valChanged + " " + counter);

                    var pos = el.position();
                    var w = el.outerWidth();
                    var h = el.outerHeight();

                    sh.css({
                        width: w,
                        height: h,
                        left: pos.left + 5,
                        top: pos.top + 5,
                        display: el.css("display"),
                        opacity: el.css("opacity")
                    });

                });

                function showStatus(msg) {
                    if (!msg) {
                        $("#AlertBox").hide();
                        return;
                    }                    
                    $("#msg").text( msg);
                    $("#AlertBox").show();
                }
            });

            $("#lnkRedisplayWindow").click(function() {
                var el$ = $("#notebox");
                
                if (el$.is(":visible"))
                    el$.fadeOut(1000);
                else
                    el$.fadeIn(1000);
            });
        </script>
    </form>
</body>
</html>
